// Fibonacci function test
extern println 1

func fib
{
	// Parameter x
	param x
	var temp;
	
	// jump if x <= 1
	pushv x
	pushi 1
	jle end

	// x > 1, call fib recursive
	// return fib (x - 1) + fib (x - 2)
	
	// (x - 2)
	pushv x
	pushi 2
	sub
	
	// fib(x - 2)
	calle fib
	
	// (x - 1)
	pushv x
	pushi 1
	sub
	
	// fib(x - 1)
	calle fib
	
	// fib(x - 1) + fib(x - 2)
	add
	
	// return fib (x - 1) + fib (x - 2)
	popv temp
	retv temp
	
	// x <= 1, return x
	label end
	retv x
}

func main
{
	// Call fibonacci with 10
	pushi 10
	call fib
	// Result on stack
	calle println
}
